&ACCESS RV
&REL 4
&PARAM DISKPATH = KRC:\R1\Program\ROS
DEFDAT eki_communication
    STRUC EventIntPair EventType event_type, INT event_id

    CONST CHAR INTERFACE_NAME[64]
    INTERFACE_NAME[] = "EkiKSSinterface"
    CONST CHAR INTERFACE_VERSION[16]
    INTERFACE_VERSION[] = "1.0.0"
    CONST INT ROS_EKI_CONN_FLAG = 105
    CONST INT ROS_EKI_RECV_FLAG = 110

    ; Helper constant for decoding axis type information
    CONST CHAR AXIS_TYPE_MAP[5, 16]
    AXIS_TYPE_MAP[1,] = "LINEAR"
    AXIS_TYPE_MAP[2,] = "NOT_USED" ; Not used
    AXIS_TYPE_MAP[3,] = "ROTATIONAL"
    AXIS_TYPE_MAP[4,] = "NOT_USED" ; Not used
    AXIS_TYPE_MAP[5,] = "ENDLESS"

    ; Constants for easier mapping of event types to integers
    CONST INT EVENT_COUNT = 11
    DECL CONST EventIntPair EVENT_INT_PAIRS[11]
    EVENT_INT_PAIRS[1] = { event_type #STARTED, event_id 0 }
    EVENT_INT_PAIRS[2] = { event_type #STOPPED, event_id 1 }
    EVENT_INT_PAIRS[3] = { event_type #CANCELLED, event_id 2 }
    EVENT_INT_PAIRS[4] = { event_type #RESET_OK, event_id 3 }
    EVENT_INT_PAIRS[5] = { event_type #ERROR, event_id 4 }
    EVENT_INT_PAIRS[6] = { event_type #CONNECTED, event_id 5 }
    EVENT_INT_PAIRS[7] = { event_type #SWITCH_OK, event_id 6 }
    EVENT_INT_PAIRS[8] = { event_type #INVALID, event_id 7 }
    EVENT_INT_PAIRS[9] = { event_type #NONE, event_id 8 }
    EVENT_INT_PAIRS[10] = { event_type #DRIVES_TURNED_ON, event_id 9 }
    EVENT_INT_PAIRS[11] = { event_type #DRIVES_TURNED_OFF, event_id 10 }

    DECL BOOL connection_flag = FALSE
    DECL EventType last_event = #NONE
ENDDAT
